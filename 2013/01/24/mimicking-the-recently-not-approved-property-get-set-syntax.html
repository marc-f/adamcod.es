<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    
        <title>Mimicking the recently not approved Property Get/Set Syntax - adamcod.es</title>
    

    

    <meta name="author" content="Adam Brett">

    <!-- style -->
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/adamcodes/">

    <!-- fonts -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet" type="text/css">
</head>
<body>
    <section class="layout-meta">
        <header>
            <p class="author vcard">
                <strong><a href="http://adamcod.es" rel="author">adamcod.es</a></strong><br />
                by <a href="http://adambrett.co.uk">Adam Brett</a>
            </p>
        </header>

        <nav>
            <ul>
                <!--li><a href="http://adambrett.co.uk/about">About</a></li-->
                <li><a href="/archive.html"><i class="icon-book"></i> Archive</a></li>
                <li><a href="http://feeds.feedburner.com/adamcodes/"><i class="icon-rss"></i> Subscribe</a></li>
                <li><a href="http://twitter.com/sixdaysad/"><i class="icon-twitter"></i> Contact</a></li>
            </ul>
        </nav>
    </section>

    <section class="layout-main">
        <article>
    <div class="instapaper_ignore entry-unrelated">

    <h1 class="entry-title"><a href="http://adamcod.es/2013/01/24/mimicking-the-recently-not-approved-property-get-set-syntax.html">Mimicking the recently not approved Property Get/Set Syntax</a></h1>
    <p class="meta"><time pubdate class="published" datetime="2013-01-24">Thursday, January 24, 2013</time></p>
    <div class="twitter-button">
        
        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://adamcod.es/2013/01/24/mimicking-the-recently-not-approved-property-get-set-syntax.html" data-text="Mimicking the recently not approved Property Get/Set Syntax by @sixdaysad">Tweet</a>
        
    </div>

    


    </div>

    <div class="entry-content">
        <p>There was a proposal<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> for a new getter and setter syntax that would have enabled you to write code like this:</p>

<div class="highlight"><pre><code class="php"><span id="True-1"><span class="cp">&lt;?php</span>
</span><span id="True-2">
</span><span id="True-3"><span class="c1">// Code sample indicating the terminology</span>
</span><span id="True-4"><span class="k">class</span> <span class="nc">TimePeriod</span>
</span><span id="True-5"><span class="p">{</span>
</span><span id="True-6">    <span class="k">private</span> <span class="nv">$Seconds</span><span class="p">;</span> <span class="c1">// &lt;-- Traditional Property</span>
</span><span id="True-7">
</span><span id="True-8">    <span class="k">public</span> <span class="nv">$Hours</span> <span class="p">{</span> <span class="c1">// &lt;-- Guarded Property</span>
</span><span id="True-9">        <span class="nx">get</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">;</span> <span class="p">}</span>   <span class="c1">// &lt;-- Accessor, more specifically a getter</span>
</span><span id="True-10">        <span class="nx">set</span><span class="p">(</span><span class="nv">$x</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span> <span class="o">=</span> <span class="nv">$x</span><span class="o">*</span> <span class="mi">3600</span><span class="p">;</span> <span class="p">}</span>    <span class="c1">// &lt;-- Accessor, more specifically a setter</span>
</span><span id="True-11">        <span class="nb">isset</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span><span class="p">);</span> <span class="p">}</span> <span class="c1">// &lt;-- Accessor, more specifically an issetter</span>
</span><span id="True-12">        <span class="nb">unset</span><span class="p">()</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span><span class="p">);</span> <span class="p">}</span>        <span class="c1">// &lt;-- Accessor, more specifically an unsetter</span>
</span><span id="True-13">    <span class="p">}</span>
</span><span id="True-14"><span class="p">}</span>
</span></code></pre></div>

<p>The benefit here, is that accessing the properties directly on an instantiated object like this:</p>

<div class="highlight"><pre><code class="php"><span id="True-1"><span class="x"> </span><span class="cp">&lt;?php</span>
</span><span id="True-2"> <span class="c1">// Accessing the property is the same as accessing a class member</span>
</span><span id="True-3"> <span class="nv">$time</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TimePeriod</span><span class="p">();</span>
</span><span id="True-4"> <span class="nv">$time</span><span class="o">-&gt;</span><span class="na">Hours</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span> <span class="c1">// Stored as 43200</span>
</span><span id="True-5"> <span class="k">echo</span> <span class="nv">$time</span><span class="o">-&gt;</span><span class="na">Hours</span><span class="p">;</span> <span class="c1">// Outputs 12</span>
</span></code></pre></div>

<p>Would result in the getters and setters being called transparently.  Neat!  There are plenty of use-cases for this, and it would drastically reduce the amount of code in a lot of libraries and frameworks that are simple getters and setters, but unfortunately a large enough minority of core-contributors disagreed, or weren’t happy with the syntax, or the implementation (or something), and the proposal failed to pass, so it won’t be making it into the language. Not so neat.</p>

<p>Fortunately, there is a way to replicate this functionality (albeit with less syntactic sugar) using PHP’s existing Magic Methods, and when combined with PHP 5.4’s traits<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>, we get something pretty close.  Consider the following:</p>

<div class="highlight"><pre><code class="php"><span id="True-1"><span class="cp">&lt;?php</span>
</span><span id="True-2"><span class="k">trait</span> <span class="nx">Accessors</span>
</span><span id="True-3"><span class="p">{</span>
</span><span id="True-4">    <span class="k">public</span> <span class="k">function</span> <span class="nf">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span><span id="True-5">    <span class="p">{</span>
</span><span id="True-6">        <span class="nv">$getter</span> <span class="o">=</span> <span class="s2">&quot;get</span><span class="si">{</span><span class="nv">$name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span id="True-7">        <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$getter</span><span class="p">))</span> <span class="p">{</span>
</span><span id="True-8">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$getter</span><span class="p">();</span>
</span><span id="True-9">        <span class="p">}</span>
</span><span id="True-10">    <span class="p">}</span>
</span><span id="True-11">
</span><span id="True-12">    <span class="k">public</span> <span class="k">function</span> <span class="nf">__set</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span>
</span><span id="True-13">    <span class="p">{</span>
</span><span id="True-14">        <span class="nv">$setter</span> <span class="o">=</span> <span class="s2">&quot;set</span><span class="si">{</span><span class="nv">$name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span id="True-15">        <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$setter</span><span class="p">))</span> <span class="p">{</span>
</span><span id="True-16">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$setter</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span><span id="True-17">        <span class="p">}</span>
</span><span id="True-18">    <span class="p">}</span>
</span><span id="True-19"><span class="p">}</span>
</span><span id="True-20">
</span><span id="True-21"><span class="c1">// Code sample indicating the terminology</span>
</span><span id="True-22"><span class="k">class</span> <span class="nc">TimePeriod</span>
</span><span id="True-23"><span class="p">{</span>
</span><span id="True-24">    <span class="k">use</span> <span class="nx">Accessors</span><span class="p">;</span>
</span><span id="True-25">
</span><span id="True-26">    <span class="k">private</span> <span class="nv">$Seconds</span><span class="p">;</span>  <span class="c1">// &lt;-- Traditional Property</span>
</span><span id="True-27">
</span><span id="True-28">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">getHours</span><span class="p">()</span>
</span><span id="True-29">    <span class="p">{</span>
</span><span id="True-30">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">;</span>
</span><span id="True-31">    <span class="p">}</span>
</span><span id="True-32">
</span><span id="True-33">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">setHours</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
</span><span id="True-34">    <span class="p">{</span>
</span><span id="True-35">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span> <span class="o">=</span> <span class="nv">$value</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">;</span>
</span><span id="True-36">    <span class="p">}</span>
</span><span id="True-37"><span class="p">}</span>
</span></code></pre></div>

<p>Now if we run our test code again:</p>

<div class="highlight"><pre><code class="php"><span id="True-1"><span class="x"> </span><span class="cp">&lt;?php</span>
</span><span id="True-2"> <span class="c1">// Accessing the property is the same as accessing a class member</span>
</span><span id="True-3"> <span class="nv">$time</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TimePeriod</span><span class="p">();</span>
</span><span id="True-4"> <span class="nv">$time</span><span class="o">-&gt;</span><span class="na">Hours</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span> <span class="c1">// Stored as 43200</span>
</span><span id="True-5"> <span class="k">echo</span> <span class="nv">$time</span><span class="o">-&gt;</span><span class="na">Hours</span><span class="p">;</span> <span class="c1">// Outputs 12</span>
</span><span id="True-6"> 
</span></code></pre></div>

<p>We get the correct output!  For PHP 5.3 we could add the magic methods directly into the class that wants to use them, or create a base class and extend everything we want to have access to the magic getter/setters from that, but that feels messy, traits seem like the cleanest way to do this.</p>

<p>If we add <code>__isset</code> and <code>__unset</code> to the <code>Accessor</code> trait, we can replicate that functionality too:</p>

<div class="highlight"><pre><code class="php"><span id="True-1"><span class="cp">&lt;?php</span>
</span><span id="True-2"><span class="k">trait</span> <span class="nx">Accessors</span>
</span><span id="True-3"><span class="p">{</span>
</span><span id="True-4">    <span class="k">public</span> <span class="k">function</span> <span class="nf">__isset</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span><span id="True-5">    <span class="p">{</span>
</span><span id="True-6">        <span class="nv">$issetter</span> <span class="o">=</span> <span class="s2">&quot;isset</span><span class="si">{</span><span class="nv">$name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span id="True-7">        <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$issetter</span><span class="p">))</span> <span class="p">{</span>
</span><span id="True-8">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$issetter</span><span class="p">();</span>
</span><span id="True-9">        <span class="p">}</span>
</span><span id="True-10">    <span class="p">}</span>
</span><span id="True-11">
</span><span id="True-12">    <span class="k">public</span> <span class="k">function</span> <span class="nf">__unset</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span><span id="True-13">    <span class="p">{</span>
</span><span id="True-14">        <span class="nv">$unsetter</span> <span class="o">=</span> <span class="s2">&quot;set</span><span class="si">{</span><span class="nv">$name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span id="True-15">        <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$unsetter</span><span class="p">))</span> <span class="p">{</span>
</span><span id="True-16">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$unsetter</span><span class="p">();</span>
</span><span id="True-17">        <span class="p">}</span>
</span><span id="True-18">    <span class="p">}</span>
</span><span id="True-19"><span class="p">}</span>
</span><span id="True-20">
</span><span id="True-21"><span class="c1">// Code sample indicating the terminology</span>
</span><span id="True-22"><span class="k">class</span> <span class="nc">TimePeriod</span>
</span><span id="True-23"><span class="p">{</span>
</span><span id="True-24">    <span class="k">use</span> <span class="nx">Accessors</span><span class="p">;</span>
</span><span id="True-25">
</span><span id="True-26">    <span class="k">private</span> <span class="nv">$Seconds</span><span class="p">;</span>  <span class="c1">// &lt;-- Traditional Property</span>
</span><span id="True-27">
</span><span id="True-28">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">issetHours</span><span class="p">()</span>
</span><span id="True-29">    <span class="p">{</span>
</span><span id="True-30">        <span class="k">return</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span><span class="p">);</span>
</span><span id="True-31">    <span class="p">}</span>
</span><span id="True-32">
</span><span id="True-33">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">unsetHours</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
</span><span id="True-34">    <span class="p">{</span>
</span><span id="True-35">        <span class="k">return</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Seconds</span><span class="p">);</span>
</span><span id="True-36">    <span class="p">}</span>
</span><span id="True-37"><span class="p">}</span>
</span></code></pre></div>

<p>Obviously this is a lot more verbose than the original RFC, but it does provide a way to mimic some of its functionality.  If you want to use it, you can see the full trait in <a href="https://gist.github.com/4621373#file-trait-full-php">this gist</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>https://wiki.php.net/rfc/propertygetsetsyntax-v1.2<a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>http://php.net/manual/en/language.oop5.traits.php<a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>

    <section>
        <form class="well form-inline text-center" action="https://tinyletter.com/adambrett" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/adambrett', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
    <p>For more exclusive content, including screen-casts, videos, and early beta access to my projects, subscribe to my email list below.</p>
    <p>
        <input type="text" name="email" placeholder="Enter your email address" /> <input type="submit" value="Subscribe" class="btn btn-primary" />
    </p>

    <input type="hidden" value="1" name="embed"/>
</form>

    </section>

    <hr>

    <footer>
        <p><small>I love discussion, but not blog comments.  If you want to comment on what's written above, head over to <a href="https://twitter.com/sixdaysad">twitter</a> or <a href="https://alpha.app.net/adambrett">ADN</a>.</small></p>
    </footer>
</article>


<hr>

<ul class="pager">
    
    <li class="previous">
        <a href="/2013/01/15/vagrant-is-easy-chef-is-hard-part2.html">&larr; Previous</a>
    </li>
    

    
    <li class="next">
        <a href="/2013/02/12/mark-old-posts-liquid-tag-jekyll.html">Next &rarr;</a>
    </li>
    
</ul>


        <footer>
            <p>Copyright &copy; 2012 <a href="http://adambrett.co.uk">Adam Brett</a>.  All rights reserved.</p>
        </footer>
    </section>

    <script>
        function setImageHeight() {
          var baseLine = 26, img, _i, _len, _ref, _results;
          _ref = document.getElementsByTagName('img');
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            img = _ref[_i];
            _results.push(img.style.height = Math.ceil(img.clientHeight / baseLine) * baseLine + "px");
          }
          return _results;
        }

        if (window.addEventListener) {
          window.addEventListener('load', setImageHeight, false);
        } else if (window.attachEvent)  {
          window.attachEvent('onload', setImageHeight);
        }
    </script>
    <script src="http://platform.twitter.com/widgets.js?ver=1.1"></script>
    <script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-10572636-6']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        // ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</body>
</html>
