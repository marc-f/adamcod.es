<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    
        <title>Mark Old Posts as Deprecated in Jekyll - adamcod.es</title>
    

    

    <meta name="author" content="Adam Brett">

    <!-- style -->
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" href="http://feeds.feedburner.com/adamcodes/">

    <!-- fonts -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet" type="text/css">
</head>
<body>
    <section class="layout-meta">
        <header>
            <p class="author vcard">
                <strong><a href="http://adamcod.es" rel="author">adamcod.es</a></strong><br />
                by <a href="http://adambrett.co.uk">Adam Brett</a>
            </p>
        </header>

        <nav>
            <ul>
                <!--li><a href="http://adambrett.co.uk/about">About</a></li-->
                <li><a href="/archive.html"><i class="icon-book"></i> Archive</a></li>
                <li><a href="http://feeds.feedburner.com/adamcodes/"><i class="icon-rss"></i> Subscribe</a></li>
                <li><a href="http://twitter.com/sixdaysad/"><i class="icon-twitter"></i> Contact</a></li>
            </ul>
        </nav>
    </section>

    <section class="layout-main">
        <article>
    <div class="instapaper_ignore entry-unrelated">

    <h1 class="entry-title"><a href="http://adamcod.es/2013/02/12/mark-old-posts-liquid-tag-jekyll.html">Mark Old Posts as Deprecated in Jekyll</a></h1>
    <p class="meta"><time pubdate class="published" datetime="2013-02-12">Tuesday, February 12, 2013</time></p>
    <div class="twitter-button">
        
        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://adamcod.es/2013/02/12/mark-old-posts-liquid-tag-jekyll.html" data-text="Mark Old Posts as Deprecated in Jekyll by @sixdaysad">Tweet</a>
        
    </div>

    


    </div>

    <div class="entry-content">
        <p>This blog is built with jekyll<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>, which is a static blogging platform from the guys at github, and is also the engine behind github pages<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>, where this blog is hosted.</p>

<p>I have written a simple plugin to add a LiquidTag<sup id="fnref:3"><a href="#fn:3" class="footnote">3</a></sup> to render a warning for all posts that reach a certain age.  This is particularly useful for technical blogs such as this one, where the things I’m writing about can move on pretty quickly.  The way something was done a year ago isn’t necessarily the way I recommend doing it today.</p>

<h2 id="using-the-plugin">Using the Plugin</h2>

<p>If you have a Gemfile, add the <code>chronic</code> gem and run <code>bundle install</code>. If you don’t have a Gemfile, install the gem with <code>gem install chronic --no-ri --no-rdoc</code>.</p>

<p>Now you can add the <code>mark_old_post_tag.rb</code> file to your <code>_plugins</code> folder.</p>

<div class="highlight"><pre><code class="ruby"><span id="True-1"><span class="c1"># Mark Old Posts Liquid Tag</span>
</span><span id="True-2"><span class="c1">#</span>
</span><span id="True-3"><span class="c1"># A liquid tag for Jekyll sites to mark old posts as deprecated</span>
</span><span id="True-4"><span class="c1">#</span>
</span><span id="True-5"><span class="c1"># Usage:</span>
</span><span id="True-6"><span class="c1">#     {% mark_old_posts &lt;time_ago_in_words|date&gt; %}</span>
</span><span id="True-7"><span class="c1">#</span>
</span><span id="True-8"><span class="c1"># Example:</span>
</span><span id="True-9"><span class="c1">#     {% mark_old_posts 6 months ago %}</span>
</span><span id="True-10"><span class="c1">#     {% mark_old_posts 1 year ago %}</span>
</span><span id="True-11"><span class="c1">#     {% mark_old_posts 01/01/2012 %}</span>
</span><span id="True-12"><span class="c1">#</span>
</span><span id="True-13"><span class="c1"># Requires:</span>
</span><span id="True-14"><span class="c1">#     chronic gem: sudo gem install chronic --no-ri --no-rdoc</span>
</span><span id="True-15"><span class="c1">#</span>
</span><span id="True-16"><span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
</span><span id="True-17"><span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="True-18"><span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="True-19"><span class="c1"># See the License for the specific language governing permissions and</span>
</span><span id="True-20"><span class="c1"># limitations under the License.</span>
</span><span id="True-21"><span class="c1">#</span>
</span><span id="True-22"><span class="c1"># @author Adam Brett &lt;adam@adambrett.co.uk&gt;</span>
</span><span id="True-23"><span class="c1"># @license BSD-3-Clause</span>
</span><span id="True-24"><span class="c1"># @version 0.1</span>
</span><span id="True-25"><span class="c1"># @link http://gist.github.com/adambrett/</span>
</span><span id="True-26"><span class="c1"># @link http://adamcod.es/2013/02/12/mark-old-posts-liquid-tag-jekyll.html</span>
</span><span id="True-27"><span class="c1">#</span>
</span><span id="True-28">
</span><span id="True-29"><span class="nb">require</span> <span class="s1">&#39;chronic&#39;</span>
</span><span id="True-30">
</span><span id="True-31"><span class="k">module</span> <span class="nn">Jekyll</span>
</span><span id="True-32">  <span class="k">class</span> <span class="nc">MarkOldPostTag</span> <span class="o">&lt;</span> <span class="ss">Liquid</span><span class="p">:</span><span class="ss">:Tag</span>
</span><span id="True-33">    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">cut_off</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
</span><span id="True-34">      <span class="k">super</span>
</span><span id="True-35">      <span class="vi">@cut_off_date</span> <span class="o">=</span> <span class="no">Chronic</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">cut_off</span><span class="p">)</span>
</span><span id="True-36">      <span class="vi">@cut_off</span> <span class="o">=</span> <span class="n">cut_off</span>
</span><span id="True-37">    <span class="k">end</span>
</span><span id="True-38">
</span><span id="True-39">    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span id="True-40">      <span class="n">post_date</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">environments</span><span class="o">.</span><span class="n">first</span><span class="o">[</span><span class="s2">&quot;page&quot;</span><span class="o">][</span><span class="s2">&quot;date&quot;</span><span class="o">]</span>
</span><span id="True-41">
</span><span id="True-42">      <span class="k">unless</span> <span class="p">(</span><span class="n">post_date</span><span class="o">.</span><span class="n">is_a?</span> <span class="no">Time</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="vi">@cut_off_date</span><span class="o">.</span><span class="n">is_a?</span> <span class="no">Time</span><span class="p">)</span>
</span><span id="True-43">        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="True-44">      <span class="k">end</span>
</span><span id="True-45">
</span><span id="True-46">      <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">environments</span><span class="o">.</span><span class="n">first</span><span class="o">[</span><span class="s2">&quot;page&quot;</span><span class="o">][</span><span class="s2">&quot;mark_old_post&quot;</span><span class="o">]</span> <span class="o">==</span> <span class="kp">false</span>
</span><span id="True-47">        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="True-48">      <span class="k">end</span>
</span><span id="True-49">
</span><span id="True-50">      <span class="k">if</span> <span class="n">post_date</span> <span class="o">&gt;</span> <span class="vi">@cut_off_date</span>
</span><span id="True-51">        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="True-52">      <span class="k">end</span>
</span><span id="True-53">
</span><span id="True-54">      <span class="n">html_output_for</span> <span class="n">context</span><span class="o">.</span><span class="n">environments</span><span class="o">.</span><span class="n">first</span><span class="o">[</span><span class="s2">&quot;page&quot;</span><span class="o">][</span><span class="s2">&quot;date&quot;</span><span class="o">]</span>
</span><span id="True-55">    <span class="k">end</span>
</span><span id="True-56">
</span><span id="True-57">    <span class="k">def</span> <span class="nf">html_output_for</span><span class="p">(</span><span class="n">post_date</span><span class="p">)</span>
</span><span id="True-58">      <span class="n">post_date</span> <span class="o">=</span> <span class="n">post_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%A, %B %d, %Y&quot;</span><span class="p">)</span>
</span><span id="True-59">      <span class="k">return</span> <span class="o">&lt;&lt;-</span><span class="no">HTML</span>
</span><span id="True-60"><span class="sh">&lt;div class=&quot;alert alert-warning&quot;&gt;</span>
</span><span id="True-61"><span class="sh">  &lt;h4&gt;Out Of Date Warning&lt;/h4&gt;</span>
</span><span id="True-62">
</span><span id="True-63"><span class="sh">  &lt;p&gt;</span>
</span><span id="True-64"><span class="sh">    This article was published on &lt;strong&gt;#{post_date}&lt;/strong&gt; which was</span>
</span><span id="True-65"><span class="sh">    &lt;strong&gt;more than #{@cut_off}&lt;/strong&gt;, this means the content may be</span>
</span><span id="True-66"><span class="sh">    out of date or no longer relevant.  You should &lt;strong&gt;verify that the</span>
</span><span id="True-67"><span class="sh">    technical information in this article is still current&lt;/strong&gt; before</span>
</span><span id="True-68"><span class="sh">    relying upon it for your own purposes.</span>
</span><span id="True-69"><span class="sh">  &lt;/p&gt;</span>
</span><span id="True-70"><span class="sh">&lt;/div&gt;</span>
</span><span id="True-71"><span class="no">      HTML</span>
</span><span id="True-72">    <span class="k">end</span>
</span><span id="True-73">  <span class="k">end</span>
</span><span id="True-74"><span class="k">end</span>
</span><span id="True-75">
</span><span id="True-76"><span class="ss">Liquid</span><span class="p">:</span><span class="ss">:Template</span><span class="o">.</span><span class="n">register_tag</span><span class="p">(</span><span class="s1">&#39;mark_old_posts&#39;</span><span class="p">,</span> <span class="ss">Jekyll</span><span class="p">:</span><span class="ss">:MarkOldPostTag</span><span class="p">)</span>
</span></code></pre></div>

<p>It’s not very customisable at the moment.  At some point in the future I’d like to allow you to specify the HTML markup without having to modify the plugin itself, but for now you have to modify the output of the <code>html_output_for</code> method if you want to change anything.</p>

<p>To render the warning message, add the tag: <code>{% mark_old_posts &lt;time ago in words|date &gt;%}</code> wherever you want the HTML to be output.  You can specify any sort of date string that <code>chronic</code> will understand here, such as <code>6 months ago</code>, <code>12 months ago</code>, or an actual date such as <code>01/01/2012</code>.  You can see the example for this site on github<sup id="fnref:4"><a href="#fn:4" class="footnote">4</a></sup></p>

<h2 id="excluding-postspages">Excluding Posts/Pages</h2>

<p>If you don’t want to deprecate an old post, set <code>mark_old_post: false</code> in the YFM for the post or page and the plugin won’t render anything.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>http://jekyllrb.com/<a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>http://pages.github.com/<a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>http://liquidmarkup.org/<a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:4">
      <p>https://github.com/adambrett/adamcod.es/blob/57014bd1d57ce765ec6b674796abe9bfc8f93a44/_includes/article.html#L8<a href="#fnref:4" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>

    <section>
        <form class="well form-inline text-center" action="https://tinyletter.com/adambrett" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/adambrett', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
    <p>For more exclusive content, including screen-casts, videos, and early beta access to my projects, subscribe to my email list below.</p>
    <p>
        <input type="text" name="email" placeholder="Enter your email address" /> <input type="submit" value="Subscribe" class="btn btn-primary" />
    </p>

    <input type="hidden" value="1" name="embed"/>
</form>

    </section>

    <hr>

    <footer>
        <p><small>I love discussion, but not blog comments.  If you want to comment on what's written above, head over to <a href="https://twitter.com/sixdaysad">twitter</a> or <a href="https://alpha.app.net/adambrett">ADN</a>.</small></p>
    </footer>
</article>


<hr>

<ul class="pager">
    
    <li class="previous">
        <a href="/2013/01/24/mimicking-the-recently-not-approved-property-get-set-syntax.html">&larr; Previous</a>
    </li>
    

    
    <li class="next">
        <a href="/2013/02/28/how-to-hire-a-developer.html">Next &rarr;</a>
    </li>
    
</ul>


        <footer>
            <p>Copyright &copy; 2012 <a href="http://adambrett.co.uk">Adam Brett</a>.  All rights reserved.</p>
        </footer>
    </section>

    <script>
        function setImageHeight() {
          var baseLine = 26, img, _i, _len, _ref, _results;
          _ref = document.getElementsByTagName('img');
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            img = _ref[_i];
            _results.push(img.style.height = Math.ceil(img.clientHeight / baseLine) * baseLine + "px");
          }
          return _results;
        }

        if (window.addEventListener) {
          window.addEventListener('load', setImageHeight, false);
        } else if (window.attachEvent)  {
          window.attachEvent('onload', setImageHeight);
        }
    </script>
    <script src="http://platform.twitter.com/widgets.js?ver=1.1"></script>
    <script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-10572636-6']);
      _gaq.push(['_trackPageview']);

      setTimeout(function() {
        window.onscroll = function() {
          window.onscroll = null; // Only track the event once
          _gaq.push(['_trackEvent', 'scroll', 'read']);
        }
      }, 5000);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</body>
</html>
